<html>
    <head>
        <title> tic-tac-toe</title>
    </head> 

    <style>
        * {
            box-sizing: border-box;
        }

        main {
            width: 90vh;
            display: flex;
            flex-wrap: wrap;
        }

       .cell {
            width: 25vh;
            height: 25vh;
            border: 1px solid black;
            font-size: 10vh;
        }

    </style>

    <body>
        <h1> tic-tac-toe</h1>
        <h2 id = 'score'> </h2>
     <main id ='board'> </main>
        <div id ='player-select'> </div>
    </body>

    <script>

// state 
    const state = {};

    const resetState = () =>  { 

    state.board = [ 
    null, null, null,
    null, null, null,
    null, null, null ];

    state.players = ['', ''] 
    state.currentPlayerIndex = 0;   
    state.score = ['0','0']
    state.lastSquareIndex = -1; // could also use .length somehow
 }

// helper functions
const getCurrentPlayer = () => state.players[state.currentPlayerIndex] // one line no return or {}
 
const changeTurn = () => {
     state.currentPlayerIndex = state.currentPlayerIndex === 0 ? 1 : 0; //ternary decides player order
}   

const renderAll = () => {
    renderBoard();
    renderPlayer();
    renderScore();
}
    
const takeTurn = (cellIndex) => {
    if (!state.players[0] || !state.players[1]) return;
    const square = state.board[cellIndex]
    if(square) return; // look at this later
    
    state.board[cellIndex]

    const lastSquareMarked = state.board[state.lastSquareIndex] || {};
    state.lastSquareIndex = cellIndex;
    
    if (square.value === lastSquareMarked.value) { // look into adding values to board for comparing
    state.scores[state.currentPlayerIndex]++
    } else {
    changeTurn();
    }
}

// DOM selectors
const boardElem = document.getElementById('board'); 
const playerTurnElem = document.getElementById('player-select');
const scoreElem = document.getElementById('score');

// DOM manipulations
const renderBoard = () => { 
    boardElem.innerHTML = ''; // reset board
    for (i = 0; i < state.board.length; i++) { // loops through board
        // const square = state.board[i]; // renames state.board[i]
        const cellElem = document.createElement('div'); // creates div elements
        cellElem.classList.add('cell'); // adds 'cell' class to cellElem
        cellElem.dataset.index = i; // adds data-index to divs
        // cellElem.innerHTML = square;
        boardElem.appendChild(cellElem); // appends cellElem to boardElem 
    }
}
const renderPlayer = () => { 
    let text;
    if (!state.players[0] || !state.players[1]) {
        text = `
            <input name ='player1' placeholder='enter player X's name'>
            <input name ='player2' placeholder='enter player 0's name'>
            <button class ='start'> Start </button>
            `
    } else {
      text = `${getCurrentPlayer()}'s turn`
    }
    playerTurnElem.innerHTML = text;
}

const renderScore = () => {
    scoreElem.innerHTML = `
    <div>${state.players[0]}: ${state.score[0]}</div>
    <div>${state.players[1]}: ${state.score[1]}</div>
    `
}

// event listeners

boardElem.addEventListener('click', (event) => { //event delegation
    if (event.target.className !== 'cell') return; //keeps user from clicking board border
 
    let cellIndex = event.target.dataset.index; //grabs data-index
    state.board[cellIndex] = '';

    changeTurn();
    renderAll();
}) 

playerTurnElem.addEventListener('click', (event) => {
    if (event.target.className !== 'start') return;

    const player1input = document.getElementsByName('player1')[0];
    state.players[0] = player1input.value;
    const player2input = document.getElementsByName('player2')[0];
    state.players[1] = player2input.value;

    renderAll();
})

//bootstrapping
resetState();
renderAll();

    </script>

</html>